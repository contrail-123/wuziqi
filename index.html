<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>äº”å­æ£‹äººæœºå¯¹æˆ˜</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #f0d9b5;
            font-family: Arial, sans-serif;
        }
        #board {
            display: grid;
            grid-template-columns: repeat(15, 40px);
            grid-template-rows: repeat(15, 40px);
            gap: 1px;
            background: #8b4513;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
        }
        .cell {
            background: #f0d9b5;
            cursor: pointer;
            position: relative;
        }
        .piece {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            position: absolute;
            top: 5px;
            left: 5px;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
        }
        .black { background: #000; }
        .white { background: #fff; border: 1px solid #666; }
        #status {
            margin: 20px;
            font-size: 24px;
            color: #634832;
        }
        button {
            padding: 10px 25px;
            font-size: 16px;
            background: #8b4513;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.3s;
        }
        button:hover { background: #634832; }
        .mode-buttons {
            margin: 15px 0;
            display: flex;
            gap: 20px;
        }
        .mode-btn {
            padding: 10px 20px;
            background: #634832;
            border-radius: 20px;
            cursor: pointer;
            color: white;
        }
        .mode-btn.active {
            background: #8b4513;
            box-shadow: 0 0 5px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <h1>äº”å­æ£‹äººæœºå¯¹æˆ˜</h1>
    <div class="mode-buttons">
        <button class="mode-btn active" onclick="setMode('black')">æ‰§é»‘å…ˆè¡Œ</button>
        <button class="mode-btn" onclick="setMode('white')">æ‰§ç™½åè¡Œ</button>
    </div>
    <div id="board"></div>
    <div id="status">å½“å‰è½®åˆ°ï¼šé»‘æ£‹</div>
    <button onclick="resetGame()">é‡æ–°å¼€å§‹</button>

    <script>
        const boardSize = 15;
        const boardElement = document.getElementById('board');
        const statusElement = document.getElementById('status');
        let currentPlayer = 'black';
        let gameOver = false;
        let boardState = Array(boardSize).fill().map(() => Array(boardSize).fill(null));
        let humanSide = 'black';
        let aiThinking = false;

        // åˆå§‹åŒ–æ£‹ç›˜
        function initBoard() {
            boardElement.innerHTML = '';
            for (let i = 0; i < boardSize; i++) {
                for (let j = 0; j < boardSize; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.x = i;
                    cell.dataset.y = j;
                    cell.addEventListener('click', handleClick);
                    boardElement.appendChild(cell);
                }
            }
        }

        // ç‚¹å‡»å¤„ç†
        function handleClick(e) {
            if (gameOver || aiThinking) return;
            if (currentPlayer !== humanSide) return;
            
            const x = parseInt(e.target.dataset.x);
            const y = parseInt(e.target.dataset.y);
            
            if (!boardState[x][y]) {
                placePiece(x, y);
                if (!gameOver) setTimeout(computerTurnCheck, 100);
            }
        }

        // è½å­é€»è¾‘
        function placePiece(x, y) {
            const piece = document.createElement('div');
            piece.className = `piece ${currentPlayer}`;
            document.querySelector(`[data-x='${x}'][data-y='${y}']`).appendChild(piece);
            boardState[x][y] = currentPlayer;

            if (checkWin(x, y)) {
                statusElement.innerHTML = `ğŸ‰ ${currentPlayer === 'black' ? 'é»‘æ£‹' : 'ç™½æ£‹'}è·èƒœï¼`;
                gameOver = true;
            } else {
                currentPlayer = currentPlayer === 'black' ? 'white' : 'black';
                statusElement.textContent = `å½“å‰è½®åˆ°ï¼š${currentPlayer === 'black' ? 'é»‘æ£‹' : 'ç™½æ£‹'}`;
            }
        }

        // ç”µè„‘å›åˆæ£€æŸ¥
        function computerTurnCheck() {
            if (!gameOver && currentPlayer !== humanSide) {
                aiThinking = true;
                setTimeout(computerMove, 500);
            }
        }

        // AIæ ¸å¿ƒç®—æ³•ï¼ˆé‚»è¿‘è¯„åˆ†ï¼‰
        function computerMove() {
            const candidates = [];
            
            // æ‰«æå…¨æ£‹ç›˜è®¡ç®—å¾—åˆ†
            for (let x = 0; x < boardSize; x++) {
                for (let y = 0; y < boardSize; y++) {
                    if (boardState[x][y]) continue;
                    
                    let score = 0;
                    // æ£€æŸ¥å‘¨å›´8æ ¼æ£‹å­
                    for (let dx = -1; dx <= 1; dx++) {
                        for (let dy = -1; dy <= 1; dy++) {
                            const nx = x + dx, ny = y + dy;
                            if (nx >=0 && nx <15 && ny >=0 && ny <15 && boardState[nx][ny]) {
                                score += 10;
                            }
                        }
                    }
                    candidates.push({x, y, score});
                }
            }
            
            // é€‰æ‹©æœ€é«˜åˆ†ä½ç½®
            const bestMove = candidates.reduce((a,b) => a.score > b.score ? a : b, {score: -1});
            placePiece(bestMove.x, bestMove.y);
            aiThinking = false;
        }

        // èƒœåˆ©åˆ¤æ–­ï¼ˆåŒåŸç‰ˆï¼‰
        function checkWin(x, y) {
            const directions = [[1,0],[0,1],[1,1],[1,-1]];
            for (const [dx, dy] of directions) {
                let count = 1;
                for (let i = 1; i < 5; i++) {
                    let nx = x + dx*i, ny = y + dy*i;
                    if (nx >=0 && nx <15 && ny >=0 && ny <15 && boardState[nx][ny] === currentPlayer) count++;
                    else break;
                }
                for (let i = 1; i < 5; i++) {
                    let nx = x - dx*i, ny = y - dy*i;
                    if (nx >=0 && nx <15 && ny >=0 && ny <15 && boardState[nx][ny] === currentPlayer) count++;
                    else break;
                }
                if (count >= 5) return true;
            }
            return false;
        }

        // æ¨¡å¼é€‰æ‹©
        function setMode(side) {
            humanSide = side;
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            resetGame();
        }

        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            boardState = Array(boardSize).fill().map(() => Array(boardSize).fill(null));
            currentPlayer = 'black';
            gameOver = false;
            statusElement.textContent = 'å½“å‰è½®åˆ°ï¼šé»‘æ£‹';
            initBoard();
            if (humanSide !== currentPlayer) setTimeout(computerMove, 500);
        }

        // åˆå§‹åŒ–
        initBoard();
    </script>
</body>
</html>
